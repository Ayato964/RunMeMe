<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Run Me Me - Stage Maker</title>
    <link rel="stylesheet" href="./src/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap');

        body {
            font-family: 'Comic Neue', cursive;
            overflow: hidden;
            /* Prevent scrolling */
        }
    </style>
</head>

<body class="bg-blue-300 h-screen w-screen flex flex-col items-center justify-center relative">

    <!-- Canvas Layer -->
    <canvas id="stagemaker-canvas" class="absolute inset-0 z-0"></canvas>

    <!-- Stage Maker UI Container -->
    <div id="stagemaker-ui" class="absolute inset-0 pointer-events-none z-10 flex flex-col justify-between p-4">

        <!-- Top Bar -->
        <div class="flex justify-between items-start pointer-events-auto w-full">
            <!-- Left: Navigation -->
            <div class="flex gap-2">
                <button id="back-btn"
                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full border-2 border-black shadow-[2px_2px_0_#000]">
                    BACK
                </button>
                <button id="reset-map-btn"
                    class="bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-2 px-4 rounded-full border-2 border-black shadow-[2px_2px_0_#000]">
                    CLEAR MAP
                </button>
            </div>

            <!-- Center: Tools -->
            <div id="inventory-bar" class="hidden flex gap-2 bg-white/80 p-2 rounded-xl border-2 border-black">
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/soil.png')" data-type="platform" data-block="soil"></button>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/plant.png')" data-type="platform" data-block="grass"></button>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/stone.png')" data-type="platform" data-block="stone"></button>
                <div class="w-1 h-16 bg-black/20 mx-1"></div>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/thorn.png')" data-type="thorn"></button>
                <div class="w-1 h-16 bg-black/20 mx-1"></div>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/onigiri.png')" data-type="item" data-block="onigiri"></button>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/icecream.png')" data-type="item"
                    data-block="icecream"></button>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform bg-cover bg-center"
                    style="background-image: url('assets/star.png')" data-type="item" data-block="star"></button>
                <div class="w-1 h-16 bg-black/20 mx-1"></div>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform flex items-center justify-center bg-red-100 text-red-500 font-bold text-2xl"
                    data-type="item_area">?</button>
                <div class="w-1 h-16 bg-black/20 mx-1"></div>
                <button id="rotate-btn"
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform flex items-center justify-center bg-blue-100 text-blue-500 font-bold text-sm flex-col"
                    data-type="rotate">
                    <span>↻</span>
                    <span>0°</span>
                </button>
                <button
                    class="block-btn w-16 h-16 border-4 border-transparent hover:scale-110 transition-transform flex items-center justify-center bg-gray-100 text-gray-500 font-bold"
                    data-type="eraser">ERASE</button>
            </div>

            <!-- Right: Checklist -->
            <div id="checklist-container" class="hidden flex-col bg-white/90 p-3 rounded-xl border-2 border-black">
                <h3 class="font-bold text-sm mb-2">Clear Conditions</h3>
                <div class="flex flex-col gap-1 text-sm">
                    <div class="flex items-center gap-2">
                        <span id="check-1.0" class="text-red-500 font-bold text-lg">☐</span>
                        <span>Speed 1.0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span id="check-2.0" class="text-red-500 font-bold text-lg">☐</span>
                        <span>Speed 2.0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span id="check-3.0" class="text-red-500 font-bold text-lg">☐</span>
                        <span>Speed 3.0</span>
                    </div>
                </div>
                <div class="h-px bg-gray-300 my-2"></div>
                <div class="flex flex-col gap-2">
                    <button id="test-play-btn"
                        class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-3 rounded border-2 border-black shadow-[2px_2px_0_#000] text-sm">
                        TEST PLAY
                    </button>
                    <button id="publish-btn" disabled
                        class="bg-gray-400 text-gray-200 cursor-not-allowed font-bold py-1 px-3 rounded border-2 border-black shadow-[2px_2px_0_#000] text-sm">
                        PUBLISH
                    </button>
                </div>
            </div>
        </div>

        <!-- Center: Initial Setup (Hidden after setup) -->
        <div id="setup-panel"
            class="absolute inset-0 flex items-center justify-center bg-black/50 pointer-events-auto z-50">
            <div class="bg-white p-8 rounded-xl border-4 border-black shadow-[8px_8px_0_#000] text-center">
                <h2 class="text-3xl font-bold mb-6">Create New Stage</h2>
                <p class="mb-4 text-xl">Select Stage Width (Chunks):</p>
                <div class="flex flex-col gap-4 justify-center mb-6 items-center">
                    <div class="flex gap-4">
                        <button
                            class="width-select-btn bg-blue-400 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg border-2 border-black shadow-[2px_2px_0_#000]"
                            data-width="10">Small (10)</button>
                        <button
                            class="width-select-btn bg-blue-400 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg border-2 border-black shadow-[2px_2px_0_#000]"
                            data-width="20">Medium (20)</button>
                        <button
                            class="width-select-btn bg-blue-400 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg border-2 border-black shadow-[2px_2px_0_#000]"
                            data-width="30">Large (30)</button>
                    </div>
                    <div class="flex items-center gap-2 mt-2">
                        <label for="custom-width" class="font-bold text-lg">Custom Width:</label>
                        <input type="number" id="custom-width" min="5" max="100" value="10" placeholder="8"
                            class="border-2 border-black rounded px-2 py-1 w-20 text-center font-bold">
                        <button id="custom-width-btn"
                            class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-4 rounded border-2 border-black shadow-[2px_2px_0_#000]">
                            SET
                        </button>
                    </div>
                </div>
                <button id="back-btn-setup" onclick="window.location.href='/index.html'"
                    class="text-gray-500 hover:underline">Cancel</button>
            </div>
        </div>

        <!-- Custom Confirm Modal (Hidden by default) -->
        <div id="confirm-modal"
            class="hidden absolute inset-0 flex items-center justify-center bg-black/50 pointer-events-auto z-50">
            <div class="bg-white p-8 rounded-xl border-4 border-black shadow-[8px_8px_0_#000] text-center">
                <h2 class="text-2xl font-bold mb-4">Clear Map?</h2>
                <p class="mb-6 text-lg">All progress will be lost.</p>
                <div class="flex gap-4 justify-center">
                    <button id="confirm-yes-btn"
                        class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg border-2 border-black shadow-[2px_2px_0_#000]">
                        YES, CLEAR
                    </button>
                    <button id="confirm-no-btn"
                        class="bg-gray-300 hover:bg-gray-400 text-black font-bold py-2 px-6 rounded-lg border-2 border-black shadow-[2px_2px_0_#000]">
                        CANCEL
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script type="module" src="/src/StageMaker.ts"></script>
</body>

</html>